# User Deletion Summary - How User Data is Handled

## ูุธุฑุฉ ุนุงูุฉ ุนูู ุญุฐู ุงููุณุชุฎุฏููู

### ๐ **ุงููุถุน ุงูุญุงูู:**

#### โ **ุญุฐู ุงููุณุชุฎุฏู ูุญุณุงุจู (Self-Delete)**
- **Endpoint**: `DELETE /api/user/delete-account`
- **ููุน ุงูุญุฐู**: **Soft Delete ุดุงูู**
- **ูุณุชุฎุฏู**: MongoDB Transactions ูุถูุงู ุงูุชูุงูู

#### โ **ุญุฐู ุงููุณุชุฎุฏู ูู ูุจู ุงูุฅุฏุงุฑุฉ (Admin Delete)**
- **ุบูุฑ ูุชููุฑ ุญุงููุงู**
- **ุงููุถุน ุงูุญุงูู**: ุงูุฅุฏุงุฑุฉ ูููููุง ููุท **ุญุธุฑ/ุฅูุบุงุก ุญุธุฑ** ุงููุณุชุฎุฏููู
- **Endpoint**: `DELETE /api/admin/users/:id/block`

---

## ๐ **ุชูุงุตูู ุญุฐู ุงููุณุชุฎุฏู ูุญุณุงุจู**

### ๐ฏ **ูุง ูุชู ุญุฐูู/ุชุนุฏููู:**

#### 1. **ุญุณุงุจ ุงููุณุชุฎุฏู (User Account)**
```javascript
// Soft Delete
{
  isActive: false,
  isDeleted: true,
  deletedAt: new Date(),
  deleteReason: 'User requested account deletion',
  // ูุณุญ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
  email: `deleted_${Date.now()}_${user.email}`,
  displayName: 'ูุณุชุฎุฏู ูุญุฐูู',
  profileImage: { /* ุตูุฑุฉ ุงูุชุฑุงุถูุฉ */ },
  fcmTokens: [], // ูุณุญ FCM tokens
  notificationSettings: { /* ุฅููุงู ุงูุฅุดุนุงุฑุงุช */ }
}
```

#### 2. **ุงูุฃุนูุงู ุงููููุฉ (Artworks)**
```javascript
// Soft Delete
{
  isAvailable: false,
  isDeleted: true,
  deletedAt: new Date(),
  deleteReason: 'Artist account deleted'
}
```

#### 3. **ุงูุชููููุงุช (Reviews)**
```javascript
// Soft Delete
{
  status: 'deleted',
  deletedAt: new Date(),
  deleteReason: 'User account deleted'
}
```

#### 4. **ุฑุณุงุฆู ุงูุฏุฑุฏุดุฉ (Chat Messages)**
```javascript
// Soft Delete
{
  isDeleted: true,
  deletedAt: new Date(),
  content: 'ุฑุณุงูุฉ ูุญุฐููุฉ',
  text: 'ุฑุณุงูุฉ ูุญุฐููุฉ'
}
```

#### 5. **ุงูุฅุดุนุงุฑุงุช (Notifications)**
```javascript
// Hard Delete - ุญุฐู ูุงูู
await notificationModel.deleteMany({ user: userId });
```

#### 6. **ุงูุทูุจุงุช ุงูุฎุงุตุฉ (Special Requests)**
```javascript
// Soft Delete
{
  status: 'cancelled',
  cancelledAt: new Date(),
  cancellationReason: 'User account deleted'
}
```

#### 7. **ุงููุนุงููุงุช (Transactions)**
```javascript
// Soft Delete ูููุนุงููุงุช ุงููุนููุฉ ููุท
{
  status: 'cancelled',
  cancelledAt: new Date(),
  cancellationReason: 'User account deleted'
}
```

#### 8. **ุงููุชุงุจุนุงุช (Follows)**
```javascript
// Hard Delete - ุญุฐู ูุงูู
await followModel.deleteMany({ 
  $or: [{ follower: userId }, { following: userId }] 
});
```

#### 9. **ุงูุชูุงุฑูุฑ (Reports)**
```javascript
// Soft Delete
{
  status: 'cancelled',
  cancelledAt: new Date(),
  cancellationReason: 'User account deleted'
}
```

#### 10. **ุงูุฑููุฒ ุงููููุฒุฉ (Tokens)**
```javascript
// Hard Delete - ุญุฐู ูุงูู
await tokenModel.deleteMany({ user: userId });
```

---

## ๐ **ุงูุฃูุงู ูุงูุฎุตูุตูุฉ**

### โ **ูุง ูุชู ุญูุงูุชู:**
- **ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ**: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุชู ุชุดููุฑู
- **ุงูุตูุฑ ุงูุดุฎุตูุฉ**: ูุชู ุงุณุชุจุฏุงููุง ุจุตูุฑุฉ ุงูุชุฑุงุถูุฉ
- **FCM Tokens**: ูุชู ูุณุญูุง ูููุน ุงูุฅุดุนุงุฑุงุช
- **ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช**: ูุชู ุฅููุงููุง

### โ **ูุง ูุชู ุงูุงุญุชูุงุธ ุจู:**
- **ุงููุนุงููุงุช ุงูููุชููุฉ**: ููุชุฏููู ุงููุงูู
- **ุงูุชููููุงุช**: ููุงุญุชูุงุธ ุจุงูุชุงุฑูุฎ
- **ุงูุฃุนูุงู ุงููููุฉ**: ููุงุญุชูุงุธ ุจุงูุชุงุฑูุฎ ุงูููู

---

## ๐ซ **ูุง ูุง ูุชู ุญุฐูู (Admin Block Only)**

### ๐ **ุงููุถุน ุงูุญุงูู ููุฅุฏุงุฑุฉ:**
```javascript
// ุงูุฅุฏุงุฑุฉ ูููููุง ููุท ุญุธุฑ/ุฅูุบุงุก ุญุธุฑ
{
  isActive: false, // ุญุธุฑ
  status: 'banned',
  blockReason: 'ุชู ุงูุญุธุฑ ูู ูุจู ุงูุฅุฏุงุฑุฉ',
  blockedAt: new Date()
}
```

### โ **ูุง ูุง ูุชู ุญุฐูู:**
- **ุงูุฃุนูุงู ุงููููุฉ**: ุชุจูู ูุชุงุญุฉ
- **ุงูุชููููุงุช**: ุชุจูู ูุดุทุฉ
- **ุงูุทูุจุงุช ุงูุฎุงุตุฉ**: ุชุจูู ูุดุทุฉ
- **ุงููุนุงููุงุช**: ุชุจูู ูุดุทุฉ
- **ุฑุณุงุฆู ุงูุฏุฑุฏุดุฉ**: ุชุจูู ูุดุทุฉ

---

## ๐ก **ุงูุชูุตูุงุช**

### ๐ฏ **ูููุณุชุฎุฏููู:**
- **ุงุณุชุฎุฏู `DELETE /api/user/delete-account`** ูุญุฐู ุญุณุงุจู ููุงุฆูุงู
- **ุณูุชู ุญุฐู ุฌููุน ุจูุงูุงุชู** ุจุดูู ุขูู ููุญุชุฑู
- **ูุง ูููู ุงูุชุฑุงุฌุน** ุนู ูุฐุง ุงูุฅุฌุฑุงุก

### ๐ฏ **ููุฅุฏุงุฑุฉ:**
- **ุงุณุชุฎุฏู `DELETE /api/admin/users/:id/block`** ูุญุธุฑ ุงููุณุชุฎุฏููู
- **ููุญุฐู ุงููุงูู**: ูุญุชุงุฌ ุงููุณุชุฎุฏู ูุญุฐู ุญุณุงุจู ุจููุณู
- **ูููู ุฅูุบุงุก ุงูุญุธุฑ** ูู ุฃู ููุช

---

## ๐ **ุงููุนุงููุงุช (Transactions)**

### โ **ุถูุงู ุงูุชูุงูู:**
```javascript
// ุงุณุชุฎุฏุงู MongoDB Transactions
const session = await mongoose.startSession();
session.startTransaction();

try {
  // ุฌููุน ุนูููุงุช ุงูุญุฐู
  await session.commitTransaction();
} catch (error) {
  await session.abortTransaction();
  throw error;
} finally {
  session.endSession();
}
```

### ๐ก๏ธ **ุถูุงูุงุช ุงูุฃูุงู:**
- **ุฅูุง ูู ุดูุก ููุฌุญ** ุฃู **ูู ุดูุก ููุดู**
- **ูุง ุชูุฌุฏ ุจูุงูุงุช ุฌุฒุฆูุฉ** ูุญุฐููุฉ
- **ุชูุงูู ุงูุจูุงูุงุช** ูุถููู

---

## ๐ **ุงูุฎูุงุตุฉ**

### โ **ูุง ูุนูู ุจุดูู ุตุญูุญ:**
1. **ุญุฐู ุงููุณุชุฎุฏู ูุญุณุงุจู**: ุดุงูู ูุขูู
2. **ุญูุงูุฉ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ**: ููุชุงุฒุฉ
3. **ุงุณุชุฎุฏุงู ุงููุนุงููุงุช**: ูุถููู
4. **ุงูุงุญุชูุงุธ ุจุงูุชุงุฑูุฎ**: ููุชุฏููู

### โ **ูุง ูุญุชุงุฌ ุชุญุณูู:**
1. **ุญุฐู ุงููุณุชุฎุฏู ูู ูุจู ุงูุฅุฏุงุฑุฉ**: ุบูุฑ ูุชููุฑ
2. **ุฎูุงุฑุงุช ุญุฐู ูุชุฏุฑุฌุฉ**: ุบูุฑ ูุชููุฑุฉ
3. **ุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช**: ุบูุฑ ูุชููุฑุฉ

### ๐ฏ **ุงูุชูุตูุฉ ุงูููุงุฆูุฉ:**
ุงููุธุงู ุงูุญุงูู **ุขูู ููุญุชุฑู** ูููุณุชุฎุฏูููุ ููู ูุญุชุงุฌ **ุฎูุงุฑุงุช ุฅุฏุงุฑูุฉ ุฅุถุงููุฉ** ููุญุฐู ุงููุงูู ูู ูุจู ุงูุฅุฏุงุฑุฉ ุนูุฏ ุงูุญุงุฌุฉ.

